"""
WITH a AS (
    SELECT
        state,
        month,
        SUM(quant) AS a_sum_quant
    FROM sales
    WHERE state = 'CA'
    GROUP BY state, month
),
b AS (
    SELECT
        state,
        MAX(quant) AS b_max_quant
    FROM sales
    GROUP BY state
)
SELECT
    a.state,
    a.month,
    a.a_sum_quant,
    b.b_max_quant
FROM a
JOIN b
  ON a.state = b.state
WHERE a.a_sum_quant >= b.b_max_quant * 2;

"""
S: state, month, 1_sum_quant, 2_max_quant
n: 2
V: state, month
F: 1_sum_quant, 2_max_quant
sigma:
  1: state == g_state and month == g_month
  2: state == g_state
G: 1_sum_quant >= 2_max_quant * 2 and state == 'CA'